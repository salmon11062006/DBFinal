<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking Portal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='guest_portal.css') }}">
</head>
<body>
    <div class="portal-container">
        <header class="portal-header">
            <h1>üè® Luxury Hotel Booking</h1>
            <p>Book your perfect stay with us</p>
        </header>

        <!-- Login/Register Selection -->
        <div class="booking-section" id="auth-selection">
            <h2>Welcome</h2>
            <p style="text-align: center; margin-bottom: 30px;">Please choose an option to continue</p>
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="showLogin()">Login</button>
                <button class="btn btn-secondary" onclick="showRegister()">Register</button>
            </div>
        </div>

        <!-- Login Section -->
        <div class="booking-section" id="login-section" style="display: none;">
            <h2>Guest Login</h2>
            <form id="login-form" class="booking-form">
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" id="login-email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label>Password *</label>
                    <input type="password" id="login-password" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
                <button type="button" class="btn btn-secondary" onclick="backToAuth()">Back</button>
            </form>
        </div>

        <!-- Register Section -->
        <div class="booking-section" id="register-section" style="display: none;">
            <h2>Register New Account</h2>
            <form id="register-form" class="booking-form">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="reg-name" placeholder="John Doe" required>
                </div>
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" id="reg-email" placeholder="john@example.com" required>
                </div>
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="reg-phone" placeholder="+1234567890" required>
                </div>
                <div class="form-group">
                    <label>Password *</label>
                    <input type="password" id="reg-password" placeholder="Create a password" required>
                </div>
                <button type="submit" class="btn btn-primary">Register</button>
                <button type="button" class="btn btn-secondary" onclick="backToAuth()">Back</button>
            </form>
        </div>

        <!-- Logged In Dashboard -->
        <div class="booking-section" id="dashboard-section" style="display: none;">
            <div class="info-card">
                <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap;">
                    <div>
                        <h3>Welcome, <span id="dash-name"></span>! üëã</h3>
                        <p><strong>Email:</strong> <span id="dash-email"></span></p>
                        <p><strong>Phone:</strong> <span id="dash-phone"></span></p>
                    </div>
                    <button class="btn btn-secondary" onclick="openEditProfileModal()">Edit Profile</button>
                </div>
                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="startBooking()">Make a Reservation</button>
                    <button class="btn btn-secondary" onclick="viewMyBookings()">My Bookings</button>
                    <button class="btn btn-secondary" onclick="logout()">Logout</button>
                    <button class="btn btn-danger" onclick="deleteAccount()">Delete Account</button>
                </div>
            </div>
        </div>

        <!-- My Bookings Section -->
        <div class="booking-section" id="bookings-section" style="display: none;">
            <h2>My Bookings</h2>
            <div id="bookings-list"></div>
            <button class="btn btn-secondary" onclick="backToDashboard()">Back to Dashboard</button>
        </div>

        <!-- Room Selection -->
        <div class="booking-section" id="rooms-section" style="display: none;">
            <h2>Select Your Room</h2>
            <div class="form-group">
                <label>Check-in Date *</label>
                <input type="date" id="search-checkin-date" required>
            </div>
            <div class="form-group">
                <label>Check-out Date *</label>
                <input type="date" id="search-checkout-date" required>
            </div>
            <button type="button" class="btn btn-primary" onclick="searchAvailableRooms()">Search Available Rooms</button>
            <div id="rooms-list" style="margin-top: 20px;"></div>
            <button type="button" class="btn btn-secondary" onclick="backToDashboard()">Back to Dashboard</button>
        </div>

        <!-- Booking Details -->
        <div class="booking-section" id="booking-details-section" style="display: none;">
            <h2>Booking Details</h2>
            <form id="booking-form" class="booking-form">
                <div class="selected-room-info" id="selected-room-info"></div>

                <div class="form-group">
                    <label>Check-in Date *</label>
                    <input type="date" id="checkin-date" required>
                </div>
                <div class="form-group">
                    <label>Check-out Date *</label>
                    <input type="date" id="checkout-date" required>
                </div>
                <div class="form-group">
                    <label>Number of Guests *</label>
                    <input type="number" id="num-guests" min="1" value="1" required>
                </div>

                <h3>Add-on Services (Optional)</h3>
                <div id="addons-list"></div>

                <div class="form-group">
                    <label>Coupon Code (Optional)</label>
                    <input type="text" id="coupon-code" placeholder="Enter coupon code">
                    <button type="button" class="btn btn-secondary" onclick="applyCoupon()">Apply</button>
                </div>

                <div class="price-summary" id="price-summary" style="display: none;">
                    <h3>Price Summary</h3>
                    <p><strong>Room Rate:</strong> $<span id="room-rate">0</span> / night</p>
                    <p><strong>Nights:</strong> <span id="nights">0</span></p>
                    <p><strong>Room Subtotal:</strong> $<span id="room-subtotal">0</span></p>
                    <p id="addons-cost-line" style="display: none;"><strong>Add-ons:</strong> $<span id="addons-cost">0</span></p>
                    <p id="discount-line" style="display: none;"><strong>Discount:</strong> -$<span id="discount-amt">0</span> (<span id="discount-pct">0</span>%)</p>
                    <p class="total-price"><strong>Total:</strong> $<span id="total-cost">0</span></p>
                </div>

                <button type="button" class="btn btn-secondary" onclick="backToRooms()">Back to Rooms</button>
                <button type="submit" class="btn btn-primary">Proceed to Payment</button>
            </form>
        </div>

        <!-- Payment Section -->
        <div class="booking-section" id="payment-section" style="display: none;">
            <h2>Payment</h2>
            <form id="payment-form" class="booking-form">
                <div id="payment-summary" class="booking-summary"></div>

                <h3>Payment Method</h3>
                <div class="payment-methods">
                    <label class="payment-method">
                        <input type="radio" name="payment" value="Credit Card" checked>
                        <span>üí≥ Credit Card</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment" value="PayPal">
                        <span>üí∞ PayPal</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment" value="Debit Card">
                        <span>üí≥ Debit Card</span>
                    </label>
                </div>

                <button type="button" class="btn btn-secondary" onclick="backToDetails()">Back</button>
                <button type="submit" class="btn btn-success">Complete Booking</button>
            </form>
        </div>

        <!-- Confirmation -->
        <div class="booking-section confirmation-section" id="confirmation-section" style="display: none;">
            <div class="confirmation-icon">‚úÖ</div>
            <h2>Booking Confirmed!</h2>
            <div id="confirmation-details"></div>
            <button class="btn btn-primary" onclick="backToDashboard()">Back to Dashboard</button>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditProfileModal()">&times;</span>
            <h2>Edit Profile</h2>
            <form id="edit-profile-form">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="edit-name" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="edit-email" required>
                </div>
                <div class="form-group">
                    <label>Phone *</label>
                    <input type="tel" id="edit-phone" required>
                </div>
                <div class="form-group">
                    <label>New Password (leave blank to keep current)</label>
                    <input type="password" id="edit-password" placeholder="Enter new password or leave blank">
                </div>
                <button type="submit" class="btn btn-primary">Update Profile</button>
                <button type="button" class="btn btn-secondary" onclick="closeEditProfileModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Edit Reservation Modal -->
    <div id="edit-booking-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditBookingModal()">&times;</span>
            <h2>Edit Reservation</h2>
            <form id="edit-booking-form">
                <input type="hidden" id="edit-res-id">
                <div class="form-group">
                    <label>Check-in Date *</label>
                    <input type="date" id="edit-checkin" required>
                </div>
                <div class="form-group">
                    <label>Check-out Date *</label>
                    <input type="date" id="edit-checkout" required>
                </div>
                <div class="form-group">
                    <label>Number of Guests *</label>
                    <input type="number" id="edit-guests" min="1" required>
                </div>
                <button type="submit" class="btn btn-primary">Update Reservation</button>
                <button type="button" class="btn btn-secondary" onclick="closeEditBookingModal()">Cancel</button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='guest_portal.js') }}"></script>
</body>
</html>